{
  "model": {
    "vocab_size": 32000,
    "hidden_size": 1536,
    "intermediate_size": 4096,
    "num_hidden_layers": 20,
    "num_attention_heads": 24,
    "num_key_value_heads": 4,
    "max_position_embeddings": 2048,
    "rms_norm_eps": 1e-05,
    "use_cache": true,
    "tie_word_embeddings": false,
    "rope_theta": 10000.0,
    "attention_dropout": 0.0,
    "hidden_dropout": 0.0,
    "num_experts": 4,
    "num_experts_per_tok": 2,
    "router_aux_loss_coef": 0.01,
    "gradient_checkpointing": true,
    "use_flash_attention": true,
    "memory_efficient_attention": true
  },
  "training": {
    "use_amp": true,
    "gradient_checkpointing": true,
    "max_grad_norm": 1.0,
    "weight_decay": 0.01,
    "optimizer": "adamw",
    "scheduler": "cosine_with_warmup",
    "dataloader_num_workers": 2,
    "dataloader_pin_memory": true,
    "torch_compile": false,
    "log_interval": 50,
    "eval_interval": 500,
    "save_interval": 1000,
    "batch_size": 2,
    "gradient_accumulation_steps": 8,
    "learning_rate": 0.0001,
    "num_epochs": 3
  }
}